<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1">  <!-- Use Chrome Frame in IE -->
    <meta name="viewport" content="width=device-width, height=device-height, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
    <meta name="description" content="Draw 3D ellipsoids, using different radii on different axes.">
    <title>Cesium Demo</title>
    <script type="text/javascript" src="../Sandcastle-header.js"></script>
    <script type="text/javascript">
    var dojoConfig = {
        baseUrl : '../../../Source',
        packages: [
            { name: 'dojo', location: '../ThirdParty/dojo-release-1.8.3-src/dojo' },
            { name: 'dijit', location: '../ThirdParty/dojo-release-1.8.3-src/dijit' },
            { name: 'dojox', location: '../ThirdParty/dojo-release-1.8.3-src/dojox' }
        ]
    };
    </script>
    <script data-dojo-config="async: 1, tlmSiblingOfDojo: 0" src="../../../ThirdParty/dojo-release-1.8.3-src/dojo/dojo.js"></script>
    <link rel="stylesheet" href="../../../ThirdParty/dojo-release-1.8.3-src/dijit/themes/claro/claro.css" type="text/css">
</head>
<body class="claro sandcastle-loading" data-sandcastle-bucket="bucket-dojo.html" data-sandcastle-title="Cesium + Dojo">
<style>
    @import url(../templates/bucket.css);
    @import url(../../../Source/Widgets/Dojo/CesiumViewerWidget.css);
</style>
<div id="cesiumContainer" class="fullSize"></div>
<div id="loadingOverlay"><h1>Loading...</h1></div>
<div id="toolbar">
<table>
  <tr>
      <td id="ellipsoidAlphaSlider"></td>
      <td>Ellipsoid alpha</td>
  </tr>
  <tr>
      <td id="holeAlphaSlider"></td>
      <td>Grid hole alpha</td>
  </tr>
  <tr>
      <td id="lineCountXSlider"></td>
      <td>Grid line count longitude</td>
  </tr>
  <tr>
      <td id="lineCountYSlider"></td>
      <td>Grid line count latitude</td>
  </tr>
  <tr>
      <td id="lineThicknessXSlider"></td>
      <td>Grid line thickness longitude</td>
  </tr>
  <tr>
      <td id="lineThicknessYSlider"></td>
      <td>Grid line thickness latitude</td>
  </tr>
  <tr>
      <td id="qSlider"></td>
      <td>Texture Quaternion</td>
  </tr>
</table>
</div>
<script id="cesium_sandcastle_script">
require([
    'Cesium', 'Widgets/Dojo/CesiumViewerWidget', 'dijit/form/HorizontalSlider'
], function(
    Cesium, CesiumViewerWidget, HorizontalSlider)
{
    "use strict";

    var adjustableGridMaterials = [];
    var adjustableEllipsoids = [];

    function createPrimitives(widget) {
        var scene = widget.scene;
        var ellipsoid = widget.centralBody.getEllipsoid();
        var primitives = scene.getPrimitives();

        var e = new Cesium.EllipsoidPrimitive();
        Sandcastle.declare(e); // For Sandcastle highlighting.
        e.center = ellipsoid.cartographicToCartesian(
            Cesium.Cartographic.fromDegrees(-75.0, 40.0, 500000.0));
        e.radii = new Cesium.Cartesian3(500000.0, 500000.0, 500000.0);
        e.material = Cesium.Material.fromType(undefined, Cesium.Material.GridType);
        e.material.uniforms.gridColor = Cesium.Color.YELLOW.clone();
        primitives.add(e);
        adjustableEllipsoids.push(e);
        adjustableGridMaterials.push(e.material);

        var e2 = new Cesium.EllipsoidPrimitive();
        Sandcastle.declare(e2); // For Sandcastle highlighting.
        e2.modelMatrix = Cesium.Transforms.eastNorthUpToFixedFrame(
            ellipsoid.cartographicToCartesian(
              Cesium.Cartographic.fromDegrees(-95.0, 40.0, 500000.0)));
        e2.radii = new Cesium.Cartesian3(200000.0, 300000.0, 500000.0);
        e2.material = Cesium.Material.fromType(scene.getContext(), Cesium.Material.GridType);
        e2.material.uniforms.gridColor = Cesium.Color.DARKVIOLET.clone();
        primitives.add(e2);
        adjustableEllipsoids.push(e2);
        adjustableGridMaterials.push(e2.material);
    }

    function createAdjustmentUserInterface() {
        var ellipsoidAlphaSlider = new HorizontalSlider({
            value : adjustableGridMaterials[0].uniforms.gridColor.alpha,
            minimum : 0.0,
            maximum : 1.0,
            intermediateChanges : true,
            style : "width:150px;",
            onChange : function(value) {
                var len = adjustableGridMaterials.length;
                for (var i = 0; i < len; ++i) {
                    adjustableGridMaterials[i].uniforms.gridColor.alpha = value;
                }
            }
        });
        ellipsoidAlphaSlider.placeAt('ellipsoidAlphaSlider');

        var holeAlphaSlider = new HorizontalSlider({
            value : adjustableGridMaterials[0].uniforms.holeAlpha,
            minimum : 0.0,
            maximum : 1.0,
            intermediateChanges : true,
            style : "width:150px;",
            onChange : function(value) {
                var len = adjustableGridMaterials.length;
                for (var i = 0; i < len; ++i) {
                    adjustableGridMaterials[i].uniforms.holeAlpha = value;
                }
            }
        });
        holeAlphaSlider.placeAt('holeAlphaSlider');

        var lineCountXSlider = new HorizontalSlider({
            value : adjustableGridMaterials[0].uniforms.lineCount.x,
            minimum : 1,
            maximum : 20,
            discreteValues: 20,
            intermediateChanges : true,
            style : "width:150px;",
            onChange : function(value) {
                var len = adjustableGridMaterials.length;
                for (var i = 0; i < len; ++i) {
                    adjustableGridMaterials[i].uniforms.lineCount.x = value;
                }
            }
        });
        lineCountXSlider.placeAt('lineCountXSlider');

        var lineCountYSlider = new HorizontalSlider({
            value : adjustableGridMaterials[0].uniforms.lineCount.y,
            minimum : 1,
            maximum : 20,
            discreteValues: 20,
            intermediateChanges : true,
            style : "width:150px;",
            onChange : function(value) {
                var len = adjustableGridMaterials.length;
                for (var i = 0; i < len; ++i) {
                    adjustableGridMaterials[i].uniforms.lineCount.y = value;
                }
            }
        });
        lineCountYSlider.placeAt('lineCountYSlider');

        var lineThicknessXSlider = new HorizontalSlider({
            value : adjustableGridMaterials[0].uniforms.lineThickness.x,
            minimum : 0.5,
            maximum : 10.0,
            intermediateChanges : true,
            style : "width:150px;",
            onChange : function(value) {
                var len = adjustableGridMaterials.length;
                for (var i = 0; i < len; ++i) {
                    adjustableGridMaterials[i].uniforms.lineThickness.x = value;
                }
            }
        });
        lineThicknessXSlider.placeAt('lineThicknessXSlider');

        var lineThicknessYSlider = new HorizontalSlider({
            value : adjustableGridMaterials[0].uniforms.lineThickness.y,
            minimum : 0.5,
            maximum : 10.0,
            intermediateChanges : true,
            style : "width:150px;",
            onChange : function(value) {
                var len = adjustableGridMaterials.length;
                for (var i = 0; i < len; ++i) {
                    adjustableGridMaterials[i].uniforms.lineThickness.y = value;
                }
            }
        });
        lineThicknessYSlider.placeAt('lineThicknessYSlider');

        var qSlider = new HorizontalSlider({
            value : 0,
            minimum : 0,
            maximum : Math.PI,
            intermediateChanges : true,
            style : "width:150px;",
            onChange : function(value) {
                var len = adjustableEllipsoids.length;
                for (var i = 0; i < len; ++i) {
                    adjustableEllipsoids[i].textureQuaternion =
                        Cesium.Quaternion.fromAxisAngle(
                            new Cesium.Cartesian3(1,0,0), value);
                }
            }
        });
        qSlider.placeAt('qSlider');
    }

    var widget = new CesiumViewerWidget({
        onObjectMousedOver : function(mousedOverObject) {
            //widget.highlightObject(mousedOverObject);
            //Sandcastle.highlight(mousedOverObject);
        }
    });
    widget.placeAt('cesiumContainer');
    widget.startup();

    createPrimitives(widget);
    createAdjustmentUserInterface();

    Sandcastle.finishedLoading();
});
</script>
</body>
</html>
